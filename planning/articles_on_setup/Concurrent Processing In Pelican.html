<!DOCTYPE html>
<!-- saved from url=(0066)http://parenchym.com/pymblog/concurrent-processing-in-pelican.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>Concurrent Processing In&nbsp;Pelican</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Dirk Makowski">

    <!-- Le styles -->
	    <link rel="stylesheet" href="http://parenchym.com/pymblog/theme/css/pymblog.css?d41d8cd9">
	    <link href="http://parenchym.com/pymblog/theme/css/bootstrap-responsive.min.css" rel="stylesheet">
    <link href="http://parenchym.com/pymblog/theme/css/pygments/autumn.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="http://parenchym.com/pymblog/theme/images/favicon.ico">
    <link rel="apple-touch-icon" href="http://parenchym.com/pymblog/theme/images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="http://parenchym.com/pymblog/theme/images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="http://parenchym.com/pymblog/theme/images/apple-touch-icon-114x114.png">

    <link href="http://parenchym.com/pymblog/" type="application/atom+xml" rel="alternate" title="The Old Man The Boat ATOM Feed">
        <link href="http://parenchym.com/pymblog/feeds/rss.xml" type="application/atom+xml" rel="alternate" title="The Old Man The Boat RSS Feed">
    
  <script type="text/javascript" async="" src="./Concurrent Processing In Pelican_files/embed.js"></script><script async="" type="text/javascript" src="./Concurrent Processing In Pelican_files/count.js"></script><script src="./Concurrent Processing In Pelican_files/alfie.f51946af45e0b561c60f768335c9eb79.js" async="" charset="UTF-8"></script></head>

  <body>
    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="http://parenchym.com/pymblog/index.html">The Old Man The Boat </a>
          <div class="nav-collapse">
            <ul class="nav">
                                                                    <li class="divider-vertical"></li>
                                              <li>
                    <a href="http://parenchym.com/pymblog/category/javascript.html">
						<i class="icon-folder-open icon-large"></i>JavaScript
					</a>
                  </li>
                                <li>
                    <a href="http://parenchym.com/pymblog/category/misc.html">
						<i class="icon-folder-open icon-large"></i>Misc
					</a>
                  </li>
                                <li>
                    <a href="http://parenchym.com/pymblog/category/projects.html">
						<i class="icon-folder-open icon-large"></i>Projects
					</a>
                  </li>
                                <li class="active">
                    <a href="http://parenchym.com/pymblog/category/python.html">
						<i class="icon-folder-open icon-large"></i>Python
					</a>
                  </li>
                                <li>
                    <a href="http://parenchym.com/pymblog/category/tech.html">
						<i class="icon-folder-open icon-large"></i>Tech
					</a>
                  </li>
              
                          <ul class="nav pull-right">
                                <li><a href="http://parenchym.com/pymblog/archives.html"><i class="icon-th-list"></i>Archives</a></li>
                          </ul>

            </ul>
            <!--<p class="navbar-text pull-right">Logged in as <a href="#">username</a></p>-->
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row">
        <div class="span9" id="content">
            <section id="content">
        <article>
                <header>
                        <h1>
                                <a href="" rel="bookmark" title="Permalink to Concurrent Processing In Pelican">
                                        Concurrent Processing In&nbsp;Pelican
                                </a>
                                                        </h1>
                </header>
                <div class="entry-content">
                <div class="well">
                        <footer class="post-info">
<abbr class="published" title="2012-12-31T00:00:00">
Mon 31 December 2012
</abbr>
&nbsp;&nbsp;
<span class="label">Category</span>
<a href="http://parenchym.com/pymblog/category/python.html"><i class="icon-folder-open"></i>Python</a>.


<span class="label">Tags</span>
	<a href="http://parenchym.com/pymblog/tag/python.html"><i class="icon-tag"></i>Python</a>
	<a href="http://parenchym.com/pymblog/tag/pelican.html"><i class="icon-tag"></i>Pelican</a>
	<a href="http://parenchym.com/pymblog/tag/multiprocessing.html"><i class="icon-tag"></i>Multiprocessing</a>
	<a href="http://parenchym.com/pymblog/tag/parallel.html"><i class="icon-tag"></i>Parallel</a>
	<a href="http://parenchym.com/pymblog/tag/concurrency.html"><i class="icon-tag"></i>Concurrency</a>
</footer><!-- /.post-info -->                </div>
                <p>Pelican’s performance in rendering large blogs can be accelerated by
transforming articles to <span class="caps">HTML</span> in parallel. For Markdown and
restructured text (reST) I provide numbers and sample code&nbsp;here.</p>
<p>To explore the timings we need rather extensive samples of texts.
On github we find a repository of German law texts as&nbsp;Markdown:</p>
<pre class="literal-block">git clone https://github.com/bundestag/gesetze.git
</pre>
<p>And James Gardner’s “The Pylons Book” provides us with restructured&nbsp;text:</p>
<pre class="literal-block">wget -r -l99 -A'*.txt' http://pylonsbook.com/
</pre>
<p>Both canons need some retouching before we can run Pelican’s readers on them.
The law texts contain some field markup, which is fine, but the fields are
enclosed in <tt class="docutils literal"><span class="pre">–</span></tt> lines. Our markdown processor does not like these.
And the files of the Pylons Book contain special directives which we must
mask for our standalone reST&nbsp;processor.</p>
<p>The code samples process some 30M characters, first sequential on a single
processor, and then with 8 workers in parallel. See the numbers (Python&nbsp;3.2).</p>
<p>Markdown:</p>
<pre class="literal-block">35223891  chars, 1000  titles
35223891  chars, 1000  titles
71.9049699306488
17.336802005767822
</pre>
<p>reST:</p>
<pre class="literal-block">33071060  chars, 460  titles
33071060  chars, 460  titles
73.695631980896
28.3037269115448
</pre>
<p><tt class="docutils literal">try_parallel_markdown.py</tt></p>
<div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">concurrent</span> <span class="kn">import</span> <span class="n">futures</span>
<span class="kn">import</span> <span class="nn">timeit</span>
<span class="kn">from</span> <span class="nn">markdown</span> <span class="kn">import</span> <span class="n">Markdown</span>


<span class="n"><span class="caps">INDIR</span></span> <span class="o">=</span> <span class="s">'../../../gesetze'</span>
<span class="n"><span class="caps">FILENAMES</span></span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n"><span class="caps">INDIR</span></span><span class="p">):</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">'.'</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">'.md'</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n"><span class="caps">FILENAMES</span></span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">root</span><span class="p">),</span> <span class="n">f</span><span class="p">))</span>
<span class="n"><span class="caps">FILENAMES</span></span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="n"><span class="caps">MAX</span></span> <span class="o">=</span> <span class="mi">1000</span> <span class="c">#len(<span class="caps">FILENAMES</span>) - 1</span>

<span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">head</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">'r'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8'</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">fh</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">head</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">'---'</span><span class="p">):</span>
                    <span class="n">head</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">continue</span>
            <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">md</span> <span class="o">=</span> <span class="n">Markdown</span><span class="p">(</span><span class="n">extensions</span><span class="o">=</span><span class="nb">set</span><span class="p">([</span><span class="s">'codehilite'</span><span class="p">,</span> <span class="s">'extra'</span><span class="p">,</span> <span class="s">'meta'</span><span class="p">]))</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s">""</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">md</span><span class="o">.</span><span class="n">Meta</span><span class="p">,</span> <span class="p">)</span>


<span class="k">def</span> <span class="nf">render_all</span><span class="p">():</span>
    <span class="n">chars</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">titles</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">content</span><span class="p">,</span> <span class="n">metadata</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="n">render</span><span class="p">,</span> <span class="n"><span class="caps">FILENAMES</span></span><span class="p">[:</span><span class="n"><span class="caps">MAX</span></span><span class="p">]):</span>
        <span class="n">chars</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metadata</span><span class="p">[</span><span class="s">'title'</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">'~<span class="caps">NO</span> <span class="caps">TITLE</span>~'</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">chars</span><span class="p">,</span> <span class="s">' chars,'</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">),</span> <span class="s">' titles'</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">render_all_parallel</span><span class="p">():</span>
    <span class="n">chars</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">titles</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">with</span> <span class="n">futures</span><span class="o">.</span><span class="n">ProcessPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">content</span><span class="p">,</span> <span class="n">metadata</span> <span class="ow">in</span> <span class="n">executor</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">render</span><span class="p">,</span> <span class="n"><span class="caps">FILENAMES</span></span><span class="p">[:</span><span class="n"><span class="caps">MAX</span></span><span class="p">]):</span>
            <span class="n">chars</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metadata</span><span class="p">[</span><span class="s">'title'</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">'~<span class="caps">NO</span> <span class="caps">TITLE</span>~'</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">chars</span><span class="p">,</span> <span class="s">' chars,'</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">),</span> <span class="s">' titles'</span><span class="p">)</span>


<span class="n">t</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="s">'render_all()'</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">setup</span><span class="o">=</span><span class="s">"from __main__ import render_all"</span><span class="p">)</span>
<span class="n">tp</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="s">'render_all_parallel()'</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">setup</span><span class="o">=</span><span class="s">"from __main__ import render_all_parallel"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">tp</span><span class="p">)</span>
</pre></div>
<p><tt class="docutils literal">try_parallel_reST.py</tt>:</p>
<div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">concurrent</span> <span class="kn">import</span> <span class="n">futures</span>
<span class="kn">import</span> <span class="nn">timeit</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">pelican.readers</span> <span class="kn">import</span> <span class="n">RstReader</span>


<span class="n"><span class="caps">INDIR</span></span> <span class="o">=</span> <span class="s">"pylonsbook.com/en/1.1/_sources"</span>
<span class="n"><span class="caps">OUTDIR</span></span> <span class="o">=</span> <span class="n"><span class="caps">INDIR</span></span>
<span class="n"><span class="caps">FILENAMES</span></span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">_TMP_FILENAMES</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n"><span class="caps">INDIR</span></span><span class="p">):</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">'.'</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">'.txt'</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">_TMP_FILENAMES</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">root</span><span class="p">),</span> <span class="n">f</span><span class="p">))</span>
<span class="n">_TMP_FILENAMES</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">_TMP_FILENAMES</span><span class="p">:</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="s">'rst'</span>
    <span class="n"><span class="caps">FILENAMES</span></span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s">'r'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8'</span><span class="p">)</span> <span class="k">as</span> <span class="n">ha</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="s">'w'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8'</span><span class="p">)</span> <span class="k">as</span> <span class="n">hb</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">sa</span> <span class="ow">in</span> <span class="n">ha</span><span class="p">:</span>
                <span class="n">sb</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">r'(\.\.\s+\w+\s*::)'</span><span class="p">,</span> <span class="s">r'   "\1"'</span><span class="p">,</span> <span class="n">sa</span><span class="p">)</span>  <span class="c"># mask '.. index::'</span>
                <span class="n">sb</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">r':\w+:`[^`]+`'</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="n">sb</span><span class="p">)</span>               <span class="c"># mask ':foo:`bar`'</span>
                <span class="n">hb</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">sb</span><span class="p">)</span>

<span class="n"><span class="caps">MAX</span></span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n"><span class="caps">FILENAMES</span></span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>


<span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">RstReader</span><span class="p">({})</span>
    <span class="n">content</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">metadata</span> <span class="p">)</span>


<span class="k">def</span> <span class="nf">render_all</span><span class="p">():</span>
    <span class="n">chars</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">titles</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">content</span><span class="p">,</span> <span class="n">metadata</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="n">render</span><span class="p">,</span> <span class="n"><span class="caps">FILENAMES</span></span><span class="p">[:</span><span class="n"><span class="caps">MAX</span></span><span class="p">]):</span>
            <span class="n">chars</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metadata</span><span class="p">[</span><span class="s">'title'</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">'~<span class="caps">NO</span> <span class="caps">TITLE</span>~'</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">chars</span><span class="p">,</span> <span class="s">' chars,'</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">),</span> <span class="s">' titles'</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">render_all_parallel</span><span class="p">():</span>
    <span class="n">chars</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">titles</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">futures</span><span class="o">.</span><span class="n">ProcessPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">content</span><span class="p">,</span> <span class="n">metadata</span> <span class="ow">in</span> <span class="n">executor</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">render</span><span class="p">,</span> <span class="n"><span class="caps">FILENAMES</span></span><span class="p">[:</span><span class="n"><span class="caps">MAX</span></span><span class="p">]):</span>
                <span class="n">chars</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metadata</span><span class="p">[</span><span class="s">'title'</span><span class="p">])</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="n">titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">'~<span class="caps">NO</span> <span class="caps">TITLE</span>~'</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">chars</span><span class="p">,</span> <span class="s">' chars,'</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">titles</span><span class="p">),</span> <span class="s">' titles'</span><span class="p">)</span>


<span class="n">t</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="s">'render_all()'</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">setup</span><span class="o">=</span><span class="s">"from __main__ import render_all"</span><span class="p">)</span>
<span class="n">tp</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="s">'render_all_parallel()'</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">setup</span><span class="o">=</span><span class="s">"from __main__ import render_all_parallel"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">tp</span><span class="p">)</span>
</pre></div>
<p>Tests were performed on this&nbsp;machine:</p>
<pre class="literal-block">Linux Morrigan 3.2.0-2-amd64 #1 SMP Mon Jun 11 17:24:18 UTC 2012 x86_64 GNU/Linux

Architecture:          x86_64
CPU op-mode(s):        32-bit, 64-bit
Byte Order:            Little Endian
CPU(s):                8
On-line CPU(s) list:   0-7
Thread(s) per core:    2
Core(s) per socket:    4
Socket(s):             1
NUMA node(s):          1
Vendor ID:             GenuineIntel
CPU family:            6
Model:                 26
Stepping:              5
CPU MHz:               1600.000
BogoMIPS:              6414.16
Virtualization:        VT-x
L1d cache:             32K
L1i cache:             32K
L2 cache:              256K
L3 cache:              8192K
NUMA node0 CPU(s):     0-7
</pre>

                </div><!-- /.entry-content -->
                                <div class="comments">
                        <div id="disqus_thread"><iframe id="dsq-2" data-disqus-uid="2" allowtransparency="true" frameborder="0" tabindex="0" title="Disqus" width="100%" src="./Concurrent Processing In Pelican_files/saved_resource.html" scrolling="no" horizontalscrolling="no" verticalscrolling="no" style="width: 100% !important; border: none !important; overflow: hidden !important; height: 321px !important;"></iframe></div>
                        <script type="text/javascript">
                           var disqus_identifier = "concurrent-processing-in-pelican.html";
                           (function() {
                                var dsq = document.createElement('script');
                                dsq.type = 'text/javascript'; dsq.async = true;
                                dsq.src = 'http://parenchym.disqus.com/embed.js';
                                (document.getElementsByTagName('head')[0] ||
                                 document.getElementsByTagName('body')[0]).appendChild(dsq);
                          })();
                        </script>
                </div>
                        </article>
</section>
        </div><!--/span-->

                <div class="span3 well sidebar-nav" id="sidebar">
            <ul class="nav nav-list">
<div id="aboutme">
	<div class="nav-header"><h4>Dirk Makowski</h4></div>
	<p>26 years programming and using computers.
	12 years freelance software developer, IT trainer, and consultant.
	<br><a href="http://parenchym.com/pw3/media/Main/Default/dirk_makowski-profile_en.pdf">Profile</a>
	 </p><div style="margin: 0px; margin-left: 3em; font-style: normal;">Available for hire</div>
	<p></p>
				<li>Professional Websites<br><a href="http://parenchym.com/">Parenchym</a></li>
			<li><a href="http://3amcode.de/">3amcode</a></li>
			<li><a href="http://parenchym.com/oldpymblog/">Old Blog</a></li>
			<li>Personal Website<br><a href="http://annwn.de/">The Annwn</a></li>
		</div>

<li class="nav-header"><h4><i class="icon-home icon-large"></i> social</h4></li>
    <li><a href="https://github.com/dmdm/"><i class="icon-github-sign icon-large"></i>github</a></li>
<li><a href="http://parenchym.com/pymblog/feeds/rss.xml" rel="alternate"><i class="icon-bookmark icon-large"></i>rss feed</a></li>

<li class="nav-header"><h4><i class="icon-folder-close icon-large"></i>Categories</h4></li>
<li>
<a href="http://parenchym.com/pymblog/category/javascript.html">
    <i class="icon-folder-open icon-large"></i>JavaScript
</a>
</li>
<li>
<a href="http://parenchym.com/pymblog/category/misc.html">
    <i class="icon-folder-open icon-large"></i>Misc
</a>
</li>
<li>
<a href="http://parenchym.com/pymblog/category/projects.html">
    <i class="icon-folder-open icon-large"></i>Projects
</a>
</li>
<li>
<a href="http://parenchym.com/pymblog/category/python.html">
    <i class="icon-folder-open icon-large"></i>Python
</a>
</li>
<li>
<a href="http://parenchym.com/pymblog/category/tech.html">
    <i class="icon-folder-open icon-large"></i>Tech
</a>
</li>

<li class="nav-header"><h4><i class="icon-tags icon-large"></i>Tags</h4></li>
<li class="tag-4">
    <a href="http://parenchym.com/pymblog/tag/requirejs.html">
        <i class="icon-tag icon-large"></i>requirejs
    </a>
</li>
<li class="tag-4">
    <a href="http://parenchym.com/pymblog/tag/bytes.html">
        <i class="icon-tag icon-large"></i>bytes
    </a>
</li>
<li class="tag-4">
    <a href="http://parenchym.com/pymblog/tag/python33.html">
        <i class="icon-tag icon-large"></i>Python3.3
    </a>
</li>
<li class="tag-4">
    <a href="http://parenchym.com/pymblog/tag/templates.html">
        <i class="icon-tag icon-large"></i>templates
    </a>
</li>
<li class="tag-4">
    <a href="http://parenchym.com/pymblog/tag/ui.html">
        <i class="icon-tag icon-large"></i>UI
    </a>
</li>
<li class="tag-2">
    <a href="http://parenchym.com/pymblog/tag/web-site.html">
        <i class="icon-tag icon-large"></i>Web Site
    </a>
</li>
<li class="tag-4">
    <a href="http://parenchym.com/pymblog/tag/bind.html">
        <i class="icon-tag icon-large"></i>bind
    </a>
</li>
<li class="tag-4">
    <a href="http://parenchym.com/pymblog/tag/tatort.html">
        <i class="icon-tag icon-large"></i>Tatort
    </a>
</li>
<li class="tag-4">
    <a href="http://parenchym.com/pymblog/tag/javascript.html">
        <i class="icon-tag icon-large"></i>JavaScript
    </a>
</li>
<li class="tag-4">
    <a href="http://parenchym.com/pymblog/tag/multiprocessing.html">
        <i class="icon-tag icon-large"></i>Multiprocessing
    </a>
</li>
<li class="tag-3">
    <a href="http://parenchym.com/pymblog/tag/pelican.html">
        <i class="icon-tag icon-large"></i>Pelican
    </a>
</li>
<li class="tag-3">
    <a href="http://parenchym.com/pymblog/tag/elfinder.html">
        <i class="icon-tag icon-large"></i>elFinder
    </a>
</li>
<li class="tag-4">
    <a href="http://parenchym.com/pymblog/tag/file-manager.html">
        <i class="icon-tag icon-large"></i>file manager
    </a>
</li>
<li class="tag-4">
    <a href="http://parenchym.com/pymblog/tag/stringio.html">
        <i class="icon-tag icon-large"></i>StringIO
    </a>
</li>
<li class="tag-4">
    <a href="http://parenchym.com/pymblog/tag/unicode.html">
        <i class="icon-tag icon-large"></i>unicode
    </a>
</li>
<li class="tag-2">
    <a href="http://parenchym.com/pymblog/tag/profiling.html">
        <i class="icon-tag icon-large"></i>Profiling
    </a>
</li>
<li class="tag-4">
    <a href="http://parenchym.com/pymblog/tag/feedgenerator.html">
        <i class="icon-tag icon-large"></i>feedgenerator
    </a>
</li>
<li class="tag-1">
    <a href="http://parenchym.com/pymblog/tag/python.html">
        <i class="icon-tag icon-large"></i>Python
    </a>
</li>
<li class="tag-4">
    <a href="http://parenchym.com/pymblog/tag/concurrency.html">
        <i class="icon-tag icon-large"></i>Concurrency
    </a>
</li>
<li class="tag-4">
    <a href="http://parenchym.com/pymblog/tag/funny.html">
        <i class="icon-tag icon-large"></i>funny
    </a>
</li>
<li class="tag-4">
    <a href="http://parenchym.com/pymblog/tag/testing.html">
        <i class="icon-tag icon-large"></i>Testing
    </a>
</li>
<li class="tag-4">
    <a href="http://parenchym.com/pymblog/tag/2to3.html">
        <i class="icon-tag icon-large"></i>2to3
    </a>
</li>
<li class="tag-4">
    <a href="http://parenchym.com/pymblog/tag/mako.html">
        <i class="icon-tag icon-large"></i>Mako
    </a>
</li>
<li class="tag-4">
    <a href="http://parenchym.com/pymblog/tag/unittest.html">
        <i class="icon-tag icon-large"></i>UnitTest
    </a>
</li>
<li class="tag-4">
    <a href="http://parenchym.com/pymblog/tag/django.html">
        <i class="icon-tag icon-large"></i>Django
    </a>
</li>
<li class="tag-2">
    <a href="http://parenchym.com/pymblog/tag/cms.html">
        <i class="icon-tag icon-large"></i>CMS
    </a>
</li>
<li class="tag-4">
    <a href="http://parenchym.com/pymblog/tag/dialoge.html">
        <i class="icon-tag icon-large"></i>Dialoge
    </a>
</li>
<li class="tag-2">
    <a href="http://parenchym.com/pymblog/tag/hosting.html">
        <i class="icon-tag icon-large"></i>Hosting
    </a>
</li>
<li class="tag-4">
    <a href="http://parenchym.com/pymblog/tag/iterator.html">
        <i class="icon-tag icon-large"></i>iterator
    </a>
</li>
<li class="tag-2">
    <a href="http://parenchym.com/pymblog/tag/fighty.html">
        <i class="icon-tag icon-large"></i>fighty
    </a>
</li>
<li class="tag-4">
    <a href="http://parenchym.com/pymblog/tag/website.html">
        <i class="icon-tag icon-large"></i>Website
    </a>
</li>
<li class="tag-2">
    <a href="http://parenchym.com/pymblog/tag/optimizing.html">
        <i class="icon-tag icon-large"></i>Optimizing
    </a>
</li>
<li class="tag-4">
    <a href="http://parenchym.com/pymblog/tag/parallel.html">
        <i class="icon-tag icon-large"></i>Parallel
    </a>
</li>
<li class="tag-4">
    <a href="http://parenchym.com/pymblog/tag/dns.html">
        <i class="icon-tag icon-large"></i>dns
    </a>
</li>
<li class="tag-2">
    <a href="http://parenchym.com/pymblog/tag/high-performance.html">
        <i class="icon-tag icon-large"></i>High Performance
    </a>
</li>
<li class="tag-2">
    <a href="http://parenchym.com/pymblog/tag/python-3.html">
        <i class="icon-tag icon-large"></i>Python 3
    </a>
</li>
<li class="tag-2">
    <a href="http://parenchym.com/pymblog/tag/py3k.html">
        <i class="icon-tag icon-large"></i>Py3k
    </a>
</li>
<li class="tag-4">
    <a href="http://parenchym.com/pymblog/tag/sprache.html">
        <i class="icon-tag icon-large"></i>Sprache
    </a>
</li>
<li class="tag-2">
    <a href="http://parenchym.com/pymblog/tag/pysite.html">
        <i class="icon-tag icon-large"></i>PySite
    </a>
</li>
<li class="tag-4">
    <a href="http://parenchym.com/pymblog/tag/deepcopy.html">
        <i class="icon-tag icon-large"></i>deepcopy
    </a>
</li>
<li class="tag-4">
    <a href="http://parenchym.com/pymblog/tag/copy.html">
        <i class="icon-tag icon-large"></i>copy
    </a>
</li>

</ul>        </div><!--/.well -->

      </div><!--/row-->

      <hr>

      <footer id="footer">
        <address id="about" class="row">
		<p class="span9">©2012 by <a href="http://parenchym.com/">Dirk Makowski</a></p>
        <p class="span3">Powered by <a href="http://pelican.notmyidea.org/">Pelican</a> and some parts
		<br> of Twitter's bootstrap.
		</p>
        </address><!-- /#about -->
      </footer>

    </div><!--/.fluid-container-->


    <script type="text/javascript">
    var disqus_shortname = 'parenchym';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>

  
</body></html>